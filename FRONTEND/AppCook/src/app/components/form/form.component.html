<form [formGroup]="form" (ngSubmit)="onSubmit()" class="generic-form">
  <div *ngFor="let field of fields()" class="form-field">
    <label [for]="field.name">{{ field.label }}</label>

    <!-- Text Input -->
    <input
      *ngIf="field.type === 'text'"
      pInputText
      [id]="field.name"
      [formControlName]="field.name"
      [placeholder]="field.placeholder || ''"
      [class.ng-invalid]="hasError(field.name)"
    />

    <!-- Email Input -->
    <input
      *ngIf="field.type === 'email'"
      pInputText
      type="email"
      [id]="field.name"
      [formControlName]="field.name"
      [placeholder]="field.placeholder || ''"
      [class.ng-invalid]="hasError(field.name)"
    />

    <!-- Password Input -->
    <p-password
      *ngIf="field.type === 'password'"
      [formControlName]="field.name"
      [inputId]="field.name"
      [placeholder]="field.placeholder || ''"
      [toggleMask]="true"
      [feedback]="false"
      styleClass="w-full"
      [class.ng-invalid]="hasError(field.name)"
    ></p-password>

    <!-- Textarea -->
    <textarea
      *ngIf="field.type === 'textarea'"
      pInputTextarea
      [id]="field.name"
      [formControlName]="field.name"
      [placeholder]="field.placeholder || ''"
      [rows]="field.rows || 3"
      [class.ng-invalid]="hasError(field.name)"
    ></textarea>

    <!-- Number Input -->
    <p-inputNumber
      *ngIf="field.type === 'number'"
      [formControlName]="field.name"
      [inputId]="field.name"
      [placeholder]="field.placeholder || ''"
      [min]="field.min"
      [max]="field.max"
      [class.ng-invalid]="hasError(field.name)"
    ></p-inputNumber>

    <!-- Dropdown -->
    <p-dropdown
      *ngIf="field.type === 'dropdown'"
      [formControlName]="field.name"
      [inputId]="field.name"
      [options]="field.options || []"
      [placeholder]="field.placeholder || 'SÃ©lectionner'"
      optionLabel="label"
      optionValue="value"
      [class.ng-invalid]="hasError(field.name)"
    ></p-dropdown>

    <!-- Date Picker -->
    <p-calendar
      *ngIf="field.type === 'date'"
      [formControlName]="field.name"
      [inputId]="field.name"
      [placeholder]="field.placeholder || 'JJ/MM/AAAA'"
      dateFormat="dd/mm/yy"
      [class.ng-invalid]="hasError(field.name)"
    ></p-calendar>

    <!-- Error Message -->
    <small *ngIf="hasError(field.name)" class="error-message">
      {{ getErrorMessage(field) }}
    </small>
  </div>

  <div class="form-actions">
    <p-button
      type="submit"
      [label]="submitLabel()"
      [loading]="loading()"
      [disabled]="form.invalid || loading()"
    ></p-button>
  </div>
</form>
